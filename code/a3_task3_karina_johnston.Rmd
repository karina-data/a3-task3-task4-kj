---
title: "Assignment 3 Task 3 - Santa Barbara LTER Urchins"
author: "Karina Johnston"
date: "10/27/2021"
output: 
  html_document: 
    theme: cerulean
---

This assignment will analyze sea urchin data from the Santa Barbara Coastal Long Term Ecological Research program. Data for both red (*Mesocentrotus franciscanus*) and purple (*Strongylocentrotus purpuratus*) urchins observed at five sites along the Santa Barbara coast are analyzed. Final Figures and Tables are produced, exploring data visualization techniques and summary statistics. 

Citation: Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. Accessed 2010-10-27. (https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b)

```{r setup, include = TRUE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Attach the packages into the setup code chunk
library(tidyverse)
library(kableExtra)
library(here)
library(janitor)
library(lubridate)
```

### Read in the data

This step reads in the urchin data .csv file from within the project folder and creates a new dataframe `urchin_data`, followed by a step to change the column headers to lower snake case using the function `clean_names()` found in the `janitor` package.

```{r}
urchin_data <- read_csv(here("data", "urchins.csv")) %>% 
  clean_names()
```

### Section 1: Size comparisons (all data)

In this section, the data will be visualized first by comparing the distributions of sizes between purple and red urchins with a finalized, faceted histogram using the `ggplot()` function with cleaned up aesthetics. 

```{r, fig.cap = "Figure 1. Size frequency data for Santa Barbara coastal red and purple urchins (data: SBC LTER)."}
ggplot(data = urchin_data, aes(x = size)) +
  geom_histogram(bins = 15, color = 4, fill = 4) +
  facet_wrap(~ common_name) +
  labs(x = "Size (cm)", y = "Number of urchins", title = "Size Frequency Histogram for Santa Barbara Urchins (Johnston)") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5),
        panel.grid = element_blank())
```

Next, a finalized summary table is created that contains the following statistics for purple and red urchins (mean, standard deviation or SD, and sample size). This code contains lots of aesthetic alterations for cleaner visiblity and labeling, including updated column header names, adding comma separators for thousands, adding a caption, and rounding the digits.

```{r}
urchin_size_stats <- urchin_data %>% 
  group_by(common_name) %>% 
  summarize(mean_size_cm = round(mean(size), 2),
            median_size_cm = round(median(size), 1),
            sd_size = round(sd(size), 2),
            sample_size = n())

kable(urchin_size_stats,
      col.names = c("Common Name", 
                    "Mean Size (cm)", 
                    "Median Size (cm)",
                    "Standard Deviation (cm)",
                    "Sample Size"),
      align = "lcccc",
      format.args = list(big.mark = ","),
#     col.names = gsub("_", " ", names(urchin_size_stats)),
      caption = "Table 1. Summary statistics for red and purple urchins on the Santa Barbara coast (Johnston).") %>% 
  kable_styling(latex_options = "striped")
```

Based on the urchin size data visualizations in Figure 1 and the summary statistics presented in Table 1, several patterns emerge about the urchin size data. The central tendency and data spread of urchin size by species (mean $\pm$ SD) showed larger red urchins (6.78 $\pm$ 1.89) than purple urchins (4.47 $\pm$ 1.18); the mean of red urchins was 34% larger than purples. Median showed a similar pattern (7.0 and 4.5, respectively). Both sample sizes were quite large (> 27,000 individual urchins). From the histogram visualization (Figure 1), the purple urchins may not be normally distributed, and instead may be exhibiting a positive skew. The red urchins appear more normally distributed.    


### Section 2: Purple urchins (by site and year)

In this Section, the purple urchin data will be explored by site and year. 

```{r}
purple_urchins <- urchin_data %>% 
  filter(common_name == "Purple Urchin") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))

```

